#!/bin/bash
# parameter 1: process name
process=$1

# Number of time to wait before using "kill -9"
WAIT_COUNT=3

# Counter to keep count of how many seconds have passed
count=0

PID=$(pgrep $process)
if [ -z "$PID" ]; then
	echo "process $process already exit"
	exit
fi

# kill
kill $PID >/dev/null

while ! ps -p $PID >/dev/null; do
	sleep 0.2
	echo "wait process $process exit..."
	# Increment the second counter
	((count++))

	# Has the process been killed? If so, exit the loop.
	if ! ps -p $PID >/dev/null; then
		echo "process $process already exit"
		break
	fi

	# Have we exceeded $WAIT_SECONDS? If so, kill the process with "kill -9"
	# and exit the loop
	if [ $count -gt $WAIT_COUNT ]; then
		kill -9 $PID
		break
	fi
done
